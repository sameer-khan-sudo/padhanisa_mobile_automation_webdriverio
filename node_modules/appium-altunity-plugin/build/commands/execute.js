"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.execute_setComponentProperty = exports.execute_setTimeScale = exports.execute_getTimeScale = exports.execute = exports.EXECUTE_PREFIX = void 0;
const driver_1 = require("appium/driver");
exports.EXECUTE_PREFIX = 'unity:';
async function execute(next, _, script, args) {
    const cmdMap = {
        setTimeScale: this.execute_setTimeScale,
        getTimeScale: this.execute_getTimeScale,
        setProperty: this.execute_setComponentProperty,
    };
    return await this.unityContextGuard(next, async () => {
        const command = script.replace(new RegExp(`^${exports.EXECUTE_PREFIX} ?`), '');
        if (!Object.keys(cmdMap).includes(command)) {
            throw new driver_1.errors.InvalidArgumentError(`There is no '${exports.EXECUTE_PREFIX}${command}' command`);
        }
        return await cmdMap[command].bind(this)(...args);
    });
}
exports.execute = execute;
async function execute_getTimeScale() {
    return await this.client.getTimeScale();
}
exports.execute_getTimeScale = execute_getTimeScale;
async function execute_setTimeScale(timeScale) {
    await this.client.setTimeScale(timeScale);
}
exports.execute_setTimeScale = execute_setTimeScale;
async function execute_setComponentProperty(args) {
    const next = async () => {
        throw new Error(`Cannot call set component property without valid element id`);
    };
    return await this.unityElementGuard(next, args.elementId, async (el) => {
        return await el.element.setComponentProperty(args.component, args.property, '', args.value);
    });
}
exports.execute_setComponentProperty = execute_setComponentProperty;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXhlY3V0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jb21tYW5kcy9leGVjdXRlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUVBLDBDQUFrRDtBQUdyQyxRQUFBLGNBQWMsR0FBRyxRQUFRLENBQUE7QUFVL0IsS0FBSyxVQUFVLE9BQU8sQ0FBdUIsSUFBaUIsRUFBRSxDQUFhLEVBQUUsTUFBYyxFQUFFLElBQVc7SUFDN0csTUFBTSxNQUFNLEdBQWtDO1FBQzFDLFlBQVksRUFBRSxJQUFJLENBQUMsb0JBQW9CO1FBQ3ZDLFlBQVksRUFBRSxJQUFJLENBQUMsb0JBQW9CO1FBQ3ZDLFdBQVcsRUFBRSxJQUFJLENBQUMsNEJBQTRCO0tBQ2pELENBQUE7SUFDRCxPQUFPLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxLQUFLLElBQUksRUFBRTtRQUNqRCxNQUFNLE9BQU8sR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksTUFBTSxDQUFDLElBQUksc0JBQWMsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUE7UUFDdEUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ3hDLE1BQU0sSUFBSSxlQUFNLENBQUMsb0JBQW9CLENBQUMsZ0JBQWdCLHNCQUFjLEdBQUcsT0FBTyxXQUFXLENBQUMsQ0FBQTtTQUM3RjtRQUNELE9BQU8sTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUE7SUFDcEQsQ0FBQyxDQUFDLENBQUE7QUFDTixDQUFDO0FBYkQsMEJBYUM7QUFFTSxLQUFLLFVBQVUsb0JBQW9CO0lBQ3RDLE9BQU8sTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksRUFBRSxDQUFBO0FBQzNDLENBQUM7QUFGRCxvREFFQztBQUVNLEtBQUssVUFBVSxvQkFBb0IsQ0FBdUIsU0FBaUI7SUFDOUUsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQTtBQUM3QyxDQUFDO0FBRkQsb0RBRUM7QUFFTSxLQUFLLFVBQVUsNEJBQTRCLENBQXVCLElBQXFCO0lBQzFGLE1BQU0sSUFBSSxHQUFHLEtBQUssSUFBSSxFQUFFO1FBQ3BCLE1BQU0sSUFBSSxLQUFLLENBQUMsNkRBQTZELENBQUMsQ0FBQTtJQUNsRixDQUFDLENBQUE7SUFDRCxPQUFPLE1BQU0sSUFBSSxDQUFDLGlCQUFpQixDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsRUFBRTtRQUNuRSxPQUFPLE1BQU0sRUFBRSxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FDeEMsSUFBSSxDQUFDLFNBQVMsRUFDZCxJQUFJLENBQUMsUUFBUSxFQUNiLEVBQUUsRUFDRixJQUFJLENBQUMsS0FBSyxDQUNiLENBQUE7SUFDTCxDQUFDLENBQUMsQ0FBQTtBQUNOLENBQUM7QUFaRCxvRUFZQyJ9